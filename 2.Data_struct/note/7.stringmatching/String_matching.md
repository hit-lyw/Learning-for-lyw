# 综述

1. 在实际工程中经常会遇到字符串匹配的问题，同事串匹配问题也是计算机科学中研究最为广泛的问题之一， 字符串匹配算法发展了十几年，广泛应用于生物信息学、信息检索等领域。本章我们将带同学们学习BF算法、KMP算法、Trie树、AC自动机这几种经典的串匹配算法。

2. 我们先来看一个比较常见的字符串匹配问题：

   已知有两个字符串，第一个字符串S长度为n，我们称之为母串， 第二个字符串T长度为，。我们称之为模式串。现在要求模式串T是否在母串S中出现过。

3. 这个问题即是字符串匹配问题中最为经典的问题。解决该问题常见的算法有BF算法、KMP算法、BM算法等，在后面的课程里我们会详细介绍BF算法和KMP算法，这里我们先来简单比较一下这两种算法的时空复杂度。

   ![img](https://wx2.sinaimg.cn/mw690/005LasY6gy1gc50attuutj31q008aab8.jpg)





# BF算法

即Brute Force(暴力)算法，是朴素的模式匹配算法。

1. 伪代码如下

   ![img](https://wx3.sinaimg.cn/mw690/005LasY6gy1gc50hnjlkhj30u205cq45.jpg)

2. BF算法嵌套了两层循环，所以时间复杂度为O(n * m)， 浅显易懂，易于实现。

3. 代码如下：







# KMP算法（流式数据大数据）

1. 学习了BF算法，我们肯定会有疑问，有没有比BF算法更高效的算法呢？

   有，KMP算法就是。

2. Knuth、Morris、Pratt这三位科学家在1977年提出的一种改进算法就是KMP算法，因此以三位科学家的名字来命名。

3. KMP算法会在匹配前预处理模式串T，得到一个next数组。借助next数组，可以在匹配过程中减少很多冗余的匹配操作，由此提高了算法的效率。KMP算法的时间复杂度为O(n + m)。

4. KMP算法有几种不同的版本，这里只介绍一种。

# SHIFT-AND算法（流式数据）

非确定性有穷性自动机

**1.构建辅助表ｄ**

集合ｄ记录模式串中每一个字符位掩码ｄm…ｄ1.如果Tj=x,则ｄ[x]的第j为设为1.否则为0.

![image-20210403143836273](/home/LYW/.config/Typora/typora-user-images/image-20210403143836273.png)

2.容器创建和更新

对于容器Ｐ，初始化为00000000．表示当前还没有即使模式串前缀又是目标串后缀。

P = (P << 1 | 1) & d[s[i]]

第１步：左移１位目的是因为输入一个字符后位数更新

第２步：或1，实际上是加１，原因是每一个新输入的字符都有可能是Ｔ的第一位，而此时也有可能满足目标的前缀和ｓ的后缀

第３步：判断新输入的字符是否在相应位置出现过

Ｐ & (1 << (n - 1)) ?= 1

判断Ｐ第ｎ位是否位1，若为1则匹配成攻

3.过程展示

目标串是cbcbcbaefd 模式串是cbcba

 

建表B：
![img](http://dl.iteye.com/upload/attachment/0083/0129/c8ae0e55-beeb-323b-8a94-dfc97be912ab.png)
![img](http://dl.iteye.com/upload/attachment/0083/0132/2bf666f5-7827-3eff-97b1-fc71c8639cad.png)
 如果你看明白了，就会发现上述做法真的很奇妙。

第5)步中，读取了c，但是模式串中的确实a，在没有读取c之前，结果是01010，这个的意思是模式串前4个字符前两个字符cb和前4个字符cbcb既是模式串的前缀，同时又是目标串的后缀。当读入第5个字符c后，经过更新D后变成了00101，这个结果表示前5个字符中，只有第1个字符c和前3个字符cbc既是模式串的前缀又是目标串的后缀。